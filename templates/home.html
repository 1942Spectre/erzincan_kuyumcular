{% extends 'base.html' %} {% block title %}Erzincan Altın Fiyatları{% endblock
title %} {% block content %}
<div class="container">
  <div class="row" style="display: flex; justify-content: center;">
    <div style="border:none; border-top-left-radius: 1rem; color:#f1faee; text-align: center; background-color: #e63946" class="col-sm-5">
      <h2>Alış: <span id="alis"> </span></h2>
    </div>
    <div style="border:none; text-align: center; color:#1d3557; border-top-right-radius: 1rem; background-color: #a8dadc" class="col-sm-5">
      <h2>Satış: <span id="satis"> </span></h2>
    </div>
    <div class="col-sm-10" style="background-color: #f1faee; border-bottom-left-radius: .5rem; border-bottom-right-radius: .5rem; text-align: center;">
      Son Güncelleme: <span id="last_reload"></span>
    </div>
  </div>
  <div
    class="row"
    style="display: flex; align-content: center; justify-content: center"
  >
    <button
      style="margin: 2rem; border-radius: 1.5rem; border:none; background-color: #f1faee; color: #1d3557"
      class="btn btn-primary"
      type="button"
      data-toggle="collapse"
      data-target="#bilezikler"
      aria-expanded="true"
      aria-controls="bilezikler"
    >
      Bilezikler
    </button>
    <button
      style="margin: 2rem; border-radius: 1.5rem; border:none; background-color: #f1faee; color: #1d3557"
      class="btn btn-primary"
      type="button"
      data-toggle="collapse"
      data-target="#sarrafiye"
      aria-expanded="true"
      aria-controls="sarrafiye"
    >
      Sarrafiye
    </button>
    <button
      style="margin: 2rem; border-radius: 1.5rem; border:none; background-color: #f1faee; color: #1d3557"
      class="btn btn-primary"
      type="button"
      data-toggle="collapse"
      data-target="#sertifikali"
      aria-expanded="true"
      aria-controls="sertifikali"
    >
      Sertifikalı
    </button>
    <button
      style="margin: 2rem; border-radius: 1.5rem; border:none; background-color: #f1faee; color: #1d3557"
      class="btn btn-primary"
      type="button"
      data-toggle="collapse"
      data-target="#iscilikli"
      aria-expanded="false"
      aria-controls="iscilikli"
    >
      İşçilikli
    </button>
  </div>
</div>
<div class="container-fluid">
  <div class="row">
    <div class="col-sm-4">
      <div class="collapse multi-collapse show" id="bilezikler">
        <table class="table table-light table-striped">
          <thead>
            <tr>
              <th scope="col">Bilezik</th>
              <th scope="col">Fiyat</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <th scope="row">Cnc ve Burma Bilezik</th>
              <td id="cnc_burma">{{context.cnc_burma}}</td>
            </tr>
            <tr>
              <th scope="row">Şarnel 10gr Üzeri</th>
              <td id="sarnel_10_uzeri">{{context.sarnel_10_uzeri}}</td>
            </tr>
            <tr>
              <th scope="row">Kaşlı Burma</th>
              <td id="kasli_burma">{{context.kasli_burma}}</td>
            </tr>
            <tr>
              <th scope="row">Örgü Bilezik</th>
              <td id="orgu_bilezik">{{context.orgu_bilezik}}</td>
            </tr>
            <tr>
              <th scope="row">Şarnel 8-10gr arası</th>
              <td id="sarnel_8_10">{{context.sarnel_8_10}}</td>
            </tr>
            <tr>
              <th scope="row">Şarnel 5-8gr arası</th>
              <td id="sarnel_5_8">{{context.sarnel_5_8}}</td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
    <div class="col-sm-4">
      <div class="collapse multi-collapse show" id="sarrafiye">
        <table class="table table-light table-striped">
          <thead>
            <tr>
              <th scope="col">Sarrafiye</th>
              <th scope="col">Yeni</th>
              <th scope="col">Eski</th>
              <th scope="col">Alış</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <th scope="row">Çeyrek</th>
              <td id="ceyrek_yeni">{{context.ceyrek_yeni}}</td>
              <td id="ceyrek_eski">{{context.ceyrek_eski}}</td>
              <td id="ceyrek_alis">{{context.ceyrek_alis}}</td>
            </tr>
            <tr>
              <th scope="row">Yarım</th>
              <td id="yarim_yeni">{{context.yarim_yeni}}</td>
              <td id="yarim_eski">{{context.yarim_eski}}</td>
              <td id="yarim_alis">{{context.yarim_alis}}</td>
            </tr>
            <tr>
              <th scope="row">Ziynet</th>
              <td id="ziynet_yeni">{{context.ziynet_yeni}}</td>
              <td id="ziynet_eski">{{context.ziynet_eski}}</td>
              <td id="ziynet_alis">{{context.ziynet_alis}}</td>
            </tr>
            <tr>
              <th scope="row">Ata</th>
              <td id="ata_satis">{{context.ata_satis}}</td>
              <td></td>
              <td id="ata_alis">{{context.ata_alis}}</td>
            </tr>
            <tr>
              <th scope="row">Beşli</th>
              <td id="besli">{{context.besli}}</td>
              <td></td>
              <td></td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
    <div class="col-sm-4">
      <div class="collapse multi-collapse show" id="sertifikali">
        <table class="table table-light table-striped">
          <thead>
            <tr>
              <th scope="col">Sertifikalı</th>
              <th scope="col">Fiyat</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <th scope="row">22 Ayar 0.5gr</th>
              <td id="_22_05">{{context._22_05}}</td>
            </tr>
            <tr>
              <th scope="row">22 Ayar 1gr</th>
              <td id="_22_1">{{context._22_1}}</td>
            </tr>
            <tr>
              <th scope="row">24 Ayar 1gr</th>
              <td id="_24_1">{{context._24_1}}</td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
    <div class="col-sm-12">
      <div class="collapse multi-collapse" id="iscilikli">
        <table class="table table-light table-striped">
          <thead>
            <tr>
              <th scope="col">İşçilikli</th>
              <th scope="col">Fiyat</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <th scope="row">14 Ayar</th>
              <td id="_14_ayar">{{context._14_ayar}}</td>
            </tr>
            <tr>
              <th scope="row">22 Ayar</th>
              <td id="_22_ayar">{{context._22_ayar}}</td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
  </div>
</div>
{% endblock content %} {% block scripts %}
<script>
  function reload_data() {
    $.get("/ajax/reload", function (data, status) {
      Object.keys(data).forEach(function (key) {
        if(key != "next_refresh"){
          document.getElementById(key).innerText = data[key];
        }
      });
    });
  }
  var months = ["Jan","Feb","Mar","Apr","May","June","July","Aug","Sept","Oct","Nov","Dec"];
  reload_data();
  function check_reload(){
    var d = new Date();
    var day = d.getDate();
    var month = d.getMonth();
    var year = d.getFullYear();
    var hours = parseInt(d.getHours());
    var mins = parseInt(d.getMinutes());
    var seconds = parseInt(d.getSeconds());

    var curtime = hours*60*60 + mins * 60 + seconds;
    var last_time = document.getElementById("last_reload").innerText;
    var last_time_array = last_time.split(" ");
    var date_array = last_time_array[0].split("-");
    var time_array = last_time_array[1].split(":");

    last_day = parseInt(date_array[2]);
    last_month = parseInt(date_array[1])-1;
    last_year = parseInt(date_array[0]);

    if (last_year != year) {
      console.log(last_year + "!=" + year);
      reload_data();
    }

    if (last_month != month){
      console.log(last_month + "!=" + month);
      reload_data();
    }

    if (last_day != day){
      console.log(last_day + "!=" + day);
      reload_data();
    }

    hours = parseInt(time_array[0]);
    mins = parseInt(time_array[1]);
    seconds = parseInt(time_array[2]);
    timediff = curtime - ( hours*60*60 + mins*60 + seconds) 
    if (timediff >= 20){
      reload_data();
      return;
    }
  }
  setInterval(check_reload, 1 * 1000);
</script>
{% endblock scripts %}
